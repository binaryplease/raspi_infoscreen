<html>
<head>
	<meta charset="utf-8">
	<title>Page1</title>

	<script src="js/keynavigation.js"></script>
	<script src="http://code.jquery.com/jquery-latest.min.js"
        type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.3/Chart.min.js"
        type="text/javascript"></script>
</head>


<body style="padding:5%; margin: 0px">

	<canvas id="myChart" style="width: 90%; height:200px; padding:0px; margin:0px"></canvas>
	<script>
	$.getJSON('http://api.openweathermap.org/data/2.5/forecast?lat=50.9382442&lon=6.9531454&units=metric&APPID=2ae98b15583d54661d45ed839f5b1095'
		, function(data){
			generateChart(data, "myChart", "Regen in mm");
		});

	function generateChart(data, id, label){
	var ctx = document.getElementById(id);
	
	var w_times = [];
	var w_rain = [];

	data.list.forEach(function(entry){
		w_times.push(new Date(entry.dt*1000).getHours());
		w_rain.push(entry.rain["3h"]);
	});

	console.log(w_times);

		var myChart = new Chart(ctx, {
		    type: 'bar',
		    data: {
		        labels: w_times.slice(0,10),
		        datasets: [{
		            label: label,
		            data: w_rain.slice(0,10),
		            backgroundColor: "rgba(51, 102, 255,0.2)",
		            borderColor: "rgba(51, 102, 255,1)",
		            borderWidth: 2,
		        }]
		    },
		    options: {
		        scales: {
		            yAxes: [{
		                ticks: {
		                    beginAtZero:true
		                }
		            }]
		        }
		    }
		});

	}
	</script>

</body>
</html>
