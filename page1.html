<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
	<title>Page1</title>

	<script src="js/keynavigation.js"></script>
	<script src="http://code.jquery.com/jquery-latest.min.js"
        type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.3/Chart.min.js"
        type="text/javascript"></script>

    <!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  </head>
  <body style="padding-top: 5%; padding-left: 5%; padding-right: 5%">

  	<div class="container-fluid">
	  	<div class="row">
		    <div class="col-sm-4">
		    	<div class="jumbotron">
				  <h1 class="display-3">AKTUELL</h1>
				  <p class="lead" id="w_temp"></p>
				  <p class="lead" id="w_description"></p>
				  <p class="lead" id="w_pressure"></p>
				  <hr class="m-y-2">
				  <p>It uses utility classes for typography and spacing to space content out within the larger container.</p>
				</div>
		    </div>
		    <div class="col-sm-8">
		    	<canvas id="myRainChart" style="width: 90%; height:200px; padding:0px; margin:0px"></canvas>
		    </div>
		</div>	
	</div>

    <!-- SKRIPTE -->
	<script>
	$.getJSON('http://api.openweathermap.org/data/2.5/weather?lat=50.9382442&lon=6.9531454&units=metric&APPID=2ae98b15583d54661d45ed839f5b1095'
		, function(data){
			generateWeatherChart(data, "w_temp", "w_description", "w_pressure");
		});

	$.getJSON('http://api.openweathermap.org/data/2.5/forecast?lat=50.9382442&lon=6.9531454&units=metric&APPID=2ae98b15583d54661d45ed839f5b1095'
		, function(data){
			generateRainChart(data, "myRainChart", "Regen in mm");
		});

	function generateWeatherChart(data, id_temp, id_desc, id_pressure){
		$( "#" + id_temp ).append("Temperature: " + data.main.temp + " Â°C");
		$( "#" + id_desc ).append("Description: " + data.weather[0].description);
		$( "#" + id_pressure ).append("Pressure: " + data.main.pressure + " hPa");
	}

	function generateRainChart(data, id, label){
		var ctx = document.getElementById(id);
		
		var w_times = [];
		var w_rain = [];

		data.list.forEach(function(entry){
			w_times.push(new Date(entry.dt*1000).getHours() + ":00 h");
			w_rain.push(entry.rain["3h"]);
		});

		var myChart = new Chart(ctx, {
		    type: 'bar',
		    data: {
		        labels: w_times.slice(0,10),
		        datasets: [{
		            label: label,
		            data: w_rain.slice(0,10),
		            backgroundColor: "rgba(51, 102, 255,0.2)",
		            borderColor: "rgba(51, 102, 255,1)",
		            borderWidth: 2,
		        }]
		    },
		    options: {
		        scales: {
		            yAxes: [{
		                ticks: {
		                    beginAtZero:true
		                }
		            }]
		        }
		    }
		});

	}
	</script>

  </body>
</html>
